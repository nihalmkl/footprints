
<!DOCTYPE HTML>
<html>
	<head>
	<title>Footwear</title>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Rokkitt:100,300,400,700" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

	
	<!-- Animate.css -->
	<link rel="stylesheet" href="/public/css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="/public/css/icomoon.css">
	<!-- Ion Icon Fonts-->
	<link rel="stylesheet" href="/public/css/ionicons.min.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="/public/css/bootstrap.min.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="/public/css/magnific-popup.css">

	<!-- Flexslider  -->
	<link rel="stylesheet" href="/public/css/flexslider.css">

	<!-- Owl Carousel -->
	<link rel="stylesheet" href="/public/css/owl.carousel.min.css">
	<link rel="stylesheet" href="/public/css/owl.theme.default.min.css">
	
	<!-- Date Picker -->
	<link rel="stylesheet" href="/public/css/bootstrap-datepicker.css">
	<!-- Flaticons  -->
	<link rel="stylesheet" href="/public/fonts/flaticon/font/flaticon.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="/public/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.3/dist/sweetalert2.min.css" rel="stylesheet">
	<style>
		.top-menu {
    display: flex;
    justify-content: space-between; /* Ensure space between logo and dropdown */
    align-items: center; /* Align items vertically in the center */
}

.menu-1 {
    display: flex;
    list-style: none;
    gap: 20px; /* Space between the menu items */
}

.nav-menu {
    display: flex; /* Display menu items horizontally */
    align-items: center; /* Center align items */
}

.user-dropdown {
    position: relative;
    margin-left: auto; /* Pushes the user dropdown to the far right */
}

.cart {
    position: relative;
}

    .dropdown {
        margin-top: 20px;
    }

    .form-select {
        width: 200px;
        border-radius: 0.375rem; 
        border: 1px solid #88c8bc
    }

    .form-select:focus {
        border-color: #88c8bc; 
        box-shadow: 0 0 0 0.2rem rgba(88, 172, 124, 0.25);
    }
    .product-entry {
    position: relative;
}

.offer-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: red;
    color: white;
    padding: 5px 10px;
    font-size: 12px;
    border-radius: 5px;
    font-weight: bold;
    z-index: 1;
}

.discounted-price {
    color: red;
    font-weight: bold;
}

.original-price {
    text-decoration: line-through;
    color: gray;
    margin-left: 10px;
}
.pagedesign .page-link {
    border-radius: 50px;
    color: #88c8bc;
    border: 1px solid #dee2e6;
    background-color: #f8f9fa;
    padding: 8px 16px;
    transition: all 0.3s ease;
    text-decoration: none;
}

.pagedesign .page-link:hover {
    color: white;
    background-color: #6b6e74;
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.3);
}

.pagedesign .active .page-link, 
.pagedesign .page-link.active-page {
    color: white !important;
    background-color: #88c8bc !important;
    border-color: #ffffff !important;
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.5);
}

.pagedesign .page-item.disabled .page-link {
    color: #6c757d;
    background-color: #e9ecef;
    border-color: #dee2e6;
}

.pagedesign .page-item.disabled .page-link:hover {
    cursor: not-allowed;
}
	</style>
	</head>
	<body>
		
		<div class="colorlib-loader"></div>
	
		<div id="page">
			<nav class="colorlib-nav" role="navigation">
				<div class="top-menu">
					<div class="container">
						<div class="row align-items-center">
							<!-- Logo Section -->
							<div class="col-sm-7 col-md-6 d-flex justify-content-start">
								<div id="colorlib-logo"><a href="/" class="text-decoration-none">FOOTPRINTS</a></div>
							</div>
					
							<!-- Search Bar Section -->
							<div class="col-sm-5 col-md-4">
                                <div class="search-wrap d-flex align-items-center">
                                    <form action="/shop" method="GET" class="d-flex w-100" id="filterForm">
                                        <input type="search"  id="searchInput" class="form-control" name="search" placeholder="Search" style="border-radius: 0;" value="<%= search || '' %>">
                                        <input type="hidden" id="sortField" name="sorting" value="<%= sorting || '' %>">
                                        <input type="hidden" id="brand" name="brand" value="<%= brand || '' %>">
                                        <input type="hidden" id="category" name="category" value="<%= category || '' %>">
                                        <button type="submit" class="btn btn-primary" style="border-radius: 0;">
                                            <i class="icon-search"></i>
                                        </button>
                                    </form>
                                </div>
                            </div>
							
					
							<!-- User Dropdown Section -->
							<div class="col-md-2 d-flex justify-content-end">
								<div class="dropdown">
									<button class="btn btn-transparent dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false" style="background-color: transparent; border: none;">
										<i class="icon-user" aria-hidden="true"></i>
									</button>
									<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
										<% if (user) { %>
											<li><a class="dropdown-item" href="/profile/<%= user._id %>">Profile</a></li>
											<li><a class="dropdown-item" href="/cart/<%= user._id %>">Cart</a></li>
											<li><a class="dropdown-item" href="/wishlist/<%= user._id %>">Wishlist</a></li>
											<li><a class="dropdown-item" href="/logout">Log Out</a></li>
										<% } else { %>
											<li><a class="dropdown-item" href="/login">Log In</a></li>
											<li><a class="dropdown-item" href="/register">Sign Up</a></li>
										<% } %>
									</ul>
								</div>
							</div>
						</div>
					
					
						<div class="row">
							<div class="col-sm-12 text-left menu-1">
								<ul>
									<li class="active"><a href="/">Home</a></li>
									<li class="has-dropdown"><a href="/shop">Shop</a></li>
									<li><a href="#">About</a></li>
									<li><a href="#">Contact</a></li>
									
									
									<% if (user) { %>
										<li class="cart">
											<a href="/wishlist/<%= user._id %>">
												<i class="icon-heart"></i>
												<% if (1 > 0) { %> 
													<span class="badge"><%= wishlistCount %></span>
												<% } %>
											</a>
										</li>
										
										<li class="cart">
											<a href="/cart/<%= user._id %>">
												<i class="icon-cart"></i>
												<% if (1 > 0) { %> 
													<span class="badge"><%= cartCount %></span>
												<% } %>
											</a>
										</li>
									<% } %>
							</div>
						</div>
					</div>
				</div>
				<div class="sale">
					<div class="container">
						<div class="row">
							<div class="col-sm-8 offset-sm-2 text-center">
								<div class="row">
									<div class="owl-carousel2">
										<div class="item">
											<div class="col">
												<h3><a href="/shop">25% off (Almost) Everything! Use Code: Summer Sale</a></h3>
											</div>
										</div>
										<div class="item">
											<div class="col">
												<h3><a href="/shop">Our biggest sale yet 50% off all summer shoes</a></h3>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</nav>

<div class="breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col">
                <p class="bread"><span><a href="/">Home</a></span> / <span>Shop</span></p>
            </div>
        </div>
    </div>
</div>

<div class="breadcrumbs-two">
    <div class="container">
        <div class="row">
            <div class="col">
                <div class="breadcrumbs-img" style="background-image: url(public/images/cover-img-1.jpg);">
                    <h2>Products</h2>
                </div>
                <div class="menu text-center">
                    <p><a href="#">New Arrivals</a> <a href="#">Best Sellers</a> <a href="#">Extended Widths</a> <a href="#">Sale</a></p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-md-6 text-end"> 
            <div class="dropdown">
                <select id="sortBy" class="form-select" name="sorting" aria-label="Sort by" onchange="sortProducts()">
                    <option value="">Sort by</option>
                    <option value="priceLowToHigh">Price: Low to High</option>
                    <option value="priceHighToLow">Price: High to Low</option>
                    <option value="newArrivals">New Arrivals</option>
                    <option value="aToZ">A to Z</option>
                    <option value="zToA">Z to A</option>
                </select>
            </div>
        </div>
    </div>
</div>

<div id="productsContainer"></div>
<div class="colorlib-product">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-xl-3">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="side border mb-1">
                            <form action="/shop" id="filterForm" method="GET">
                                <input type="hidden" name="search" value="<%= search || '' %>">
                                <input type="hidden" name="sorting" value="<%= sorting || '' %>">
                                
                                <!-- Brand Filter -->
                                <div class="form-group mb-4 mt-5 d-flex justify-content-between align-items-center">
                                    <label for="brandFilter" class="form-label mb-0"><i class="fas fa-tags"></i> Brand</label>
                                    <select class="form-select sort-input w-50" name="brand" id="brandFilter">
                                        <option value="">All Brands</option>
                                        <% if (allBrands.length != 0) { %>
                                            <% allBrands.forEach((element) => { %>
                                                <option value="<%= element.brand_name %>" <%= element.brand_name === selectedBrand ? 'selected' : '' %>>
                                                    <%= element.brand_name %>
                                                </option>
                                            <% }) %>
                                        <% } %>
                                    </select>
                                </div>
                                
                                <!-- Category Filter -->
                                <div class="form-group mb-4 mt-4 d-flex justify-content-between align-items-center">
                                    <label for="categoryFilter" class="form-label mb-0"><i class="fas fa-th-list"></i> Category</label>
                                    <select class="form-select sort-input w-50" name="category" id="categoryFilter">
                                        <option value="">All Categories</option>
                                        <% if (allCategories.length != 0) { %>
                                            <% allCategories.forEach((element) => { %>
                                                <option value="<%= element.category_name %>" <%= element.category_name === selectedCategory ? 'selected' : '' %>>
                                                    <%= element.category_name %>
                                                </option>
                                            <% }) %>
                                        <% } %>
                                    </select>
                                </div>
                                
                                <!-- Apply Filters Button -->
                                <button class="btn btn-secondary btn-block mt-3" type="submit">
                                    <i class="fas fa-check"></i> Apply Filters
                                </button>
                            </form> 
                        </div>
                    </div>
                    
                    <div class="col-sm-12">
                        <div class="side border mb-1">
                            <h3>Size/Width</h3>
                            <div class="block-26 mb-2">
                                <h4>Size</h4>
                           <ul>
                              <li><a href="#">5</a></li>
                              <li><a href="#">6</a></li>
                              <li><a href="#">7</a></li>
                              <li><a href="#">7.5</a></li>
                              <li><a href="#">8</a></li>
                              <li><a href="#">8.5</a></li>
                              <li><a href="#">9</a></li>
                              <li><a href="#">10</a></li>
                           </ul>
                        </div>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        <div class="side border mb-1">
                            <h3>Style</h3>
                            <ul>
                                <li><a href="#">Boots</a></li>
                                <li><a href="#">Loafers</a></li>
                                <li><a href="#">Sneakers</a></li>
                                <li><a href="#">Oxfords</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        <div class="side border mb-1">
                            <h3>Colors</h3>
                            <ul>
                                <li><a href="#">Black</a></li>
                                <li><a href="#">White</a></li>
                                <li><a href="#">Blue</a></li>
                                <li><a href="#">Grey</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <d<div class="col-lg-9 col-xl-9">
                <div class="row row-pb-md">
                    <% if (products.length > 0) { %>
                        <% products.forEach((product) => { %>
                            <div class="col-lg-4 mb-4 text-center">
                                <div class="product-entry border">
                                    
                                    <% if (product.offer && product.applied_discount_percentage > 0) { %>
                                        <div class="offer-badge">
                                            <%= product.applied_discount_percentage %>% OFF
                                        </div>
                                    <% } %>
                                    
                                    <a href="/product-view/<%= product._id %>" class="prod-img">
                                        <img src="<%= product.images[0] %>" class="img-fluid" alt="Product Image">
                                    </a>
                                    
                                    <div class="desc">
                                        <h2><a href="/product_view/<%= product._id%>"><%= product.product_name %></a></h2>
                                        
                                        <span class="price">
                                            <% if (product.applied_discount_percentage > 0) { %>
                                                <span class="discounted-price" style="color: red; font-weight: bold;">
                                                    ₹<%= (product.variants[0].price * (1 - product.applied_discount_percentage / 100)).toFixed(2) %>
                                                </span>
                                                <span class="original-price" style="text-decoration: line-through; color: gray;">
                                                    ₹<%= product.variants[0].price %>
                                                </span>
                                            <% } else { %>
                                                ₹<%= product.variants[0].price %>
                                            <% } %>
                                        </span>
            
                                        <p class="star">
                                            <span style="color: rgb(227, 211, 29);">
                                                <i class="icon-star-full"></i>
                                                <i class="icon-star-full"></i>
                                                <i class="icon-star-full"></i>
                                                <i class="icon-star-full"></i>
                                                <i class="icon-star-empty"></i>
                                            </span>
                                            (85%)
                                        </p>
            
                                        <div class="icons d-flex justify-content-center mt-2">
                                            <p class="addtowishlist">
                                                <% if (user) { %>
                                                    <button type="button" class="btn btn-outline-danger" 
                                                            onclick="addToWishlist('<%= user._id %>', '<%= product._id %>')">
                                                        <i class="fa fa-heart" aria-hidden="true"></i>
                                                    </button>
                                                <% } else { %>
                                                    <button type="button" class="btn btn-outline-danger" 
                                                            onclick="goTologin()">
                                                        <i class="fa fa-heart" aria-hidden="true"></i>
                                                    </button>
                                                <% } %>
                                            </p>
                                            <p class="addtocart">
                                                <% if (user) { %>
                                                    <button type="button" class="btn btn-success" 
                                                            onclick="addToCart('<%= user._id %>', '<%= product._id %>', 1)">
                                                        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
                                                    </button>
                                                <% } else { %>
                                                    <button type="button" class="btn btn-success" 
                                                            onclick="goTologin()">
                                                        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
                                                    </button>
                                                <% } %>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div>
                            <h1>No Products</h1>
                        </div>
                    <% } %>
                </div>
            </div>
            
            <div class="row">
                <div class="d-flex justify-content-center mt-5 mb-5">
                    <nav aria-label="Page navigation">
                        <ul class="pagination pagination-lg pagedesign">
                            <!-- Previous Button -->
                            <% if (currentPage > 1) { %>
                                <li class="page-item">
                                    <a class="page-link rounded-pill shadow-sm" href="/shop?page=<%= currentPage - 1 %>">&laquo; Previous</a>
                                </li>
                            <% } else { %>
                                <li class="page-item disabled">
                                    <span class="page-link rounded-pill shadow-sm">&laquo; Previous</span>
                                </li>
                            <% } %>
            
                            <!-- Page Numbers -->
                            <% for (let i = 1; i <= totalPage; i++) { %>
                                <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                    <a class="page-link rounded-pill shadow-sm <%= currentPage === i ? 'active-page' : '' %>" href="/shop?page=<%= i %>"><%= i %></a>
                                </li>
                            <% } %>
            
                            <!-- Next Button -->
                            <% if (currentPage < totalPage) { %>
                                <li class="page-item">
                                    <a class="page-link rounded-pill shadow-sm" href="/shop?page=<%= currentPage + 1 %>">Next &raquo;</a>
                                </li>
                            <% } else { %>
                                <li class="page-item disabled">
                                    <span class="page-link rounded-pill shadow-sm">Next &raquo;</span>
                                </li>
                            <% } %>
                        </ul>
                    </nav>
                </div>
            </div>
            
            </div>
        </div>
    </div>
</div>

<div class="colorlib-partner">
    <div class="container">
        <div class="row">
            <div class="col-sm-8 offset-sm-2 text-center colorlib-heading colorlib-heading-sm">
                <h2>Trusted Partners</h2>
            </div>
        </div>
        <div class="row">
            <div class="col partner-col text-center">
                <img src="public/images/brand-1.jpg" class="img-fluid-logo" alt="Free html4 bootstrap 4 template">
            </div>
            <div class="col partner-col text-center">
                <img src="public/images/brand-2.jpg" class="img-fluid-logo" alt="Free html4 bootstrap 4 template">
            </div>
            <div class="col partner-col text-center">
                <img src="public/images/brand-3.jpg" class="img-fluid-logo" alt="Free html4 bootstrap 4 template">
            </div>
            <div class="col partner-col text-center">
                <img src="public/images/brand-4.jpg" class="img-fluid-logo" alt="Free html4 bootstrap 4 template">
            </div>
            <div class="col partner-col text-center">
                <img src="public/images/brand-5.jpg" class="img-fluid-logo" alt="Free html4 bootstrap 4 template">
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function addToWishlist(userId, productId) {
    fetch('/wishlist/add', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ userId, productId }),
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            Swal.fire({
                title: "Added!",
                text: data.message,
                icon: "success",
                timer: 1500,
                showConfirmButton: false
            });
        }
    })
    .catch(error => {
        console.error('Error:', error);
        Swal.fire({
            title: "Error!",
            text: "Something went wrong. Please try again.",
            icon: "error",
            timer: 1500,
            showConfirmButton: false
        });
    });
}

  function addToCart(userId, productId, quantity) {

    const selectedQuantity = quantity    
    console.log(selectedQuantity)
    fetch('/cart/add', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ userId, productId, quantity: selectedQuantity }),
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            Swal.fire({
                title: "Success!",
                text: data.message,
                icon: "success",
                timer: 1500,
                showConfirmButton: false
            });
            setTimeout(() => {
                window.location.reload();  
            }, 1000);
        } else {
            Swal.fire({
                title: "Error!",
                text: data.message,
                icon: "error",
                timer: 1500,
                showConfirmButton: false
            });
        }
    })
    .catch(error => {
        console.error('Error:', error);
        Swal.fire({
            title: "Error!",
            text: "Something went wrong. Please try again.",
            icon: "error",
            timer: 1500,
            showConfirmButton: false
        });
    });
}

function sortProducts() {
        const sortOption = document.getElementById('sortBy').value;
        document.getElementById('sortField').value = sortOption;
        document.getElementById('filterForm').submit();
    }

	function goTologin(){
	 window.location.href = '/login'
}
</script>
   

<%- include('../partials/footer.ejs') %>